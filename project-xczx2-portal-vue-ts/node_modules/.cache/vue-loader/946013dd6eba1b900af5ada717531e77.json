{"remainingRequest":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\src\\module-organization\\pages\\live-manage\\live-list.vue?vue&type=script&lang=ts&","dependencies":[{"path":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\src\\module-organization\\pages\\live-manage\\live-list.vue","mtime":1584973675722},{"path":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660903053464},{"path":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\node_modules\\babel-loader\\lib\\index.js","mtime":1576202003988},{"path":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\node_modules\\ts-loader\\index.js","mtime":1660903053026},{"path":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660903053464},{"path":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\node_modules\\vue-loader\\lib\\index.js","mtime":1660903053930}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQppbXBvcnQgeyBDb21wb25lbnQsIFZ1ZSwgV2F0Y2ggfSBmcm9tICd2dWUtcHJvcGVydHktZGVjb3JhdG9yJw0KaW1wb3J0IFBhZ2luYXRpb24gZnJvbSAnQC9jb21wb25lbnRzL3BhZ2luYXRpb24vaW5kZXgudnVlJw0KaW1wb3J0IHsNCiAgSUxpdmVQYWdlTGlzdCwNCiAgSUxpdmVDb3Vyc2VEVE8sDQogIElQdXNoVXJsRFRPDQp9IGZyb20gJ0AvZW50aXR5L2xpdmUtcGFnZS1saXN0Jw0KaW1wb3J0IHsgZ2V0TGl2ZVBhZ2VMaXN0LCBnZXRQdXNoVXJsIH0gZnJvbSAnQC9hcGkvbGl2ZScNCg0KQENvbXBvbmVudCh7DQogIGNvbXBvbmVudHM6IHsNCiAgICBQYWdpbmF0aW9uDQogIH0NCn0pDQpleHBvcnQgZGVmYXVsdCBjbGFzcyBMaXZlTGlzdCBleHRlbmRzIFZ1ZSB7DQogIC8vIOaYr+WQpui9veWFpeS4rQ0KICBwcml2YXRlIGxpc3RMb2FkaW5nOiBib29sZWFuID0gZmFsc2UNCiAgLy8g6K+35rGC5Y+C5pWwUXVlcnkNCiAgcHJpdmF0ZSBsaXN0UXVlcnkgPSB7DQogICAgcGFnZU5vOiAxLA0KICAgIHBhZ2VTaXplOiAxMA0KICB9DQogIC8vIOivt+axguWPguaVsGJvZHkNCiAgcHJpdmF0ZSBsaXN0UXVlcnlEYXRhID0gew0KICAgIGNvdXJzZU5hbWU6ICcnDQogIH0NCiAgLy8g55u05pKt5YiX6KGoDQogIHByaXZhdGUgbGlzdFJlc3VsdDogSUxpdmVQYWdlTGlzdCA9IHt9DQoNCiAgLyoqDQogICAqIOebtOaSreWIl+ihqA0KICAgKi8NCiAgcHJpdmF0ZSBhc3luYyBnZXRMaXZlUGFnZUxpc3QoKSB7DQogICAgdGhpcy5saXN0TG9hZGluZyA9IHRydWUNCiAgICB0aGlzLmxpc3RSZXN1bHQgPSBhd2FpdCBnZXRMaXZlUGFnZUxpc3QodGhpcy5saXN0UXVlcnksIHRoaXMubGlzdFF1ZXJ5RGF0YSkNCiAgICB0aGlzLmxpc3RMb2FkaW5nID0gZmFsc2UNCiAgfQ0KDQogIC8qKg0KICAgKiDojrflj5bmjqjmtYHlnLDlnYANCiAgICovDQogIHByaXZhdGUgYXN5bmMgaGFuZGxlR2V0UHVzaFVybChyb3c6IElMaXZlQ291cnNlRFRPKSB7DQogICAgbGV0IHJlc3VsdDogSVB1c2hVcmxEVE8gPSBhd2FpdCBnZXRQdXNoVXJsKHJvdykNCiAgICBpZiAocmVzdWx0LnN0YXRlICE9PSAwKSB7DQogICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKGDojrflj5bmjqjmtYHlnLDlnYDlpLHotKXvvJoke3Jlc3VsdC5tZXNzYWdlfWApDQogICAgICByZXR1cm4NCiAgICB9DQogICAgcm93LnB1c2hVcmwgPSByZXN1bHQucHVzaFVybA0KICB9DQoNCiAgLy8g55uR5o6nIHdhdGNoDQogIC8vIOaQnOe0ouagjw0KICBAV2F0Y2goJ2xpc3RRdWVyeURhdGEnLCB7IGRlZXA6IHRydWUsIGltbWVkaWF0ZTogdHJ1ZSB9KQ0KICBwcml2YXRlIHdhdGNoTGlzdFF1ZXJ5RGF0YShuZXdWYWw6IHN0cmluZykgew0KICAgIGlmIChuZXdWYWwgPT0gJycpIHsNCiAgICAgIHJldHVybg0KICAgIH0NCiAgICB0aGlzLmdldExpdmVQYWdlTGlzdCgpDQogIH0NCg0KICAvLyDnv7vpobUgcGFnZVNpemUNCiAgQFdhdGNoKCdsaXN0UXVlcnkucGFnZVNpemUnLCB7IGltbWVkaWF0ZTogdHJ1ZSB9KQ0KICBwcml2YXRlIHdhdGNoTGlzdFF1ZXJ5UGFnZVNpemUobmV3VmFsOiBudW1iZXIpIHsNCiAgICB0aGlzLmxpc3RRdWVyeS5wYWdlTm8gPSAxDQogIH0NCn0NCg=="},{"version":3,"sources":["live-list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"live-list.vue","sourceRoot":"src/module-organization/pages/live-manage","sourcesContent":["<template>\r\n  <div class=\"course-list portal-content\">\r\n    <div class=\"workspace\">\r\n      <div class=\"banner\">\r\n        <span class=\"primary-title\">直播管理</span>\r\n      </div>\r\n\r\n      <!-- 搜索栏 -->\r\n      <div class=\"searcher\">\r\n        <el-input\r\n          class=\"el-input\"\r\n          placeholder=\"直播列表\"\r\n          suffix-icon=\"el-icon-search\"\r\n          v-model=\"listQueryData.courseName\"\r\n        />\r\n      </div>\r\n\r\n      <!-- 数据列表 -->\r\n      <el-table\r\n        class=\"dataList\"\r\n        v-loading=\"listLoading\"\r\n        :data=\"listResult.items\"\r\n        border\r\n        style=\"width: 100%\"\r\n        :header-cell-style=\"{ textAlign: 'center' }\"\r\n      >\r\n        <el-table-column prop=\"courseName\" label=\"课程信息\" width=\"400\" align=\"center\"></el-table-column>\r\n\r\n        <el-table-column prop=\"teachplanName\" label=\"课程大纲\" align=\"center\"></el-table-column>\r\n\r\n        <el-table-column label=\"直播时间\" align=\"center\">\r\n          <template slot-scope=\"scope\">{{ scope.row.liveStart | dateTimeFormat }}</template>\r\n        </el-table-column>\r\n\r\n        <el-table-column label=\"类型\" align=\"center\">\r\n          <template slot-scope=\"scope\">{{ scope.row.isPreview === '1' ? '免费' : '收费'}}</template>\r\n        </el-table-column>\r\n\r\n        <el-table-column label=\"推流地址\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <span v-if=\"scope.row.pushUrl\">{{ scope.row.pushUrl }}</span>\r\n            <el-button v-else type=\"text\" size=\"mini\" @click=\"handleGetPushUrl(scope.row)\">获取推流地址</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <!-- 翻页控制 -->\r\n      <div class=\"dataList-pagination\">\r\n        <Pagination\r\n          v-show=\"listResult.counts > 0\"\r\n          :total=\"listResult.counts\"\r\n          :page.sync=\"listQuery.pageNo\"\r\n          :limit.sync=\"listQuery.pageSize\"\r\n          @pagination=\"getLivePageList\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { Component, Vue, Watch } from 'vue-property-decorator'\r\nimport Pagination from '@/components/pagination/index.vue'\r\nimport {\r\n  ILivePageList,\r\n  ILiveCourseDTO,\r\n  IPushUrlDTO\r\n} from '@/entity/live-page-list'\r\nimport { getLivePageList, getPushUrl } from '@/api/live'\r\n\r\n@Component({\r\n  components: {\r\n    Pagination\r\n  }\r\n})\r\nexport default class LiveList extends Vue {\r\n  // 是否载入中\r\n  private listLoading: boolean = false\r\n  // 请求参数Query\r\n  private listQuery = {\r\n    pageNo: 1,\r\n    pageSize: 10\r\n  }\r\n  // 请求参数body\r\n  private listQueryData = {\r\n    courseName: ''\r\n  }\r\n  // 直播列表\r\n  private listResult: ILivePageList = {}\r\n\r\n  /**\r\n   * 直播列表\r\n   */\r\n  private async getLivePageList() {\r\n    this.listLoading = true\r\n    this.listResult = await getLivePageList(this.listQuery, this.listQueryData)\r\n    this.listLoading = false\r\n  }\r\n\r\n  /**\r\n   * 获取推流地址\r\n   */\r\n  private async handleGetPushUrl(row: ILiveCourseDTO) {\r\n    let result: IPushUrlDTO = await getPushUrl(row)\r\n    if (result.state !== 0) {\r\n      this.$message.error(`获取推流地址失败：${result.message}`)\r\n      return\r\n    }\r\n    row.pushUrl = result.pushUrl\r\n  }\r\n\r\n  // 监控 watch\r\n  // 搜索栏\r\n  @Watch('listQueryData', { deep: true, immediate: true })\r\n  private watchListQueryData(newVal: string) {\r\n    if (newVal == '') {\r\n      return\r\n    }\r\n    this.getLivePageList()\r\n  }\r\n\r\n  // 翻页 pageSize\r\n  @Watch('listQuery.pageSize', { immediate: true })\r\n  private watchListQueryPageSize(newVal: number) {\r\n    this.listQuery.pageNo = 1\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.course-list {\r\n  .nav-bar {\r\n    margin-top: 16px;\r\n  }\r\n\r\n  .workspace .banner .btn-add {\r\n    float: right;\r\n  }\r\n\r\n  .searcher {\r\n    margin-top: 16px;\r\n\r\n    div {\r\n      width: 218px;\r\n      margin-right: 10px;\r\n    }\r\n  }\r\n\r\n  .dataList {\r\n    margin-top: 16px;\r\n  }\r\n\r\n  .dataList-pagination {\r\n    text-align: center;\r\n    width: 100%;\r\n  }\r\n}\r\n</style>\r\n"]}]}