{"remainingRequest":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\src\\module-organization\\pages\\course-manage\\course-add-step1-base.vue?vue&type=script&lang=ts&","dependencies":[{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\src\\module-organization\\pages\\course-manage\\course-add-step1-base.vue","mtime":1662539345432},{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660903053464},{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\babel-loader\\lib\\index.js","mtime":1576202003988},{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\ts-loader\\index.js","mtime":1660903053026},{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660903053464},{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\vue-loader\\lib\\index.js","mtime":1660903053930}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KaW1wb3J0IHsgQ29tcG9uZW50LCBQcm9wLCBQcm9wU3luYywgV2F0Y2gsIFZ1ZSB9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InDQppbXBvcnQgeyBJS1ZEYXRhIH0gZnJvbSAnQC9hcGkvdHlwZXMnDQppbXBvcnQgeyBDT1VTRV9HUkFERV9TVEFUVVMsIENPVVJTRV9DSEFSR0VfVFlQRV9TVEFUVVMgfSBmcm9tICdAL2FwaS9jb25zdGFudHMnDQppbXBvcnQgeyBjYXRlZ29yeSwgc3VibWl0QmFzZUluZm8sIGdldEJhc2VJbmZvIH0gZnJvbSAnQC9hcGkvY291cnNlcycNCmltcG9ydCB7IElDb3Vyc2VDYXRlZ29yeSwgSUNvdXJzZUJhc2VJbmZvIH0gZnJvbSAnQC9lbnRpdHkvY291cnNlLWFkZC1iYXNlJw0KaW1wb3J0IHsgRWxGb3JtIH0gZnJvbSAnZWxlbWVudC11aS90eXBlcy9mb3JtJw0KaW1wb3J0IENvbW1vbkVudGVyaW5nU3RlcDJVcGxvYWRJbWFnZSBmcm9tICdAL21vZHVsZS1lbnRlcmluZy9wYWdlcy9lbnRlcmluZy9jb21wb25lbnRzL2NvbW1vbi1lbnRlcmluZy1zdGVwMi11cGxvYWQtaW1hZ2UudnVlJw0KDQpAQ29tcG9uZW50KHsNCiAgbmFtZTogJ0NvdXJzZUFkZFN0ZXAxQmFzZUluZm8nLA0KICBjb21wb25lbnRzOiB7DQogICAgQ29tbW9uRW50ZXJpbmdTdGVwMlVwbG9hZEltYWdlDQogIH0NCn0pDQpleHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIFZ1ZSB7DQogIEBQcm9wU3luYygnY291cnNlQmFzZUlkJywge30pDQogIHN5bmNDb3Vyc2VCYXNlSWQhOiBudW1iZXINCg0KICBAUHJvcCh7IHR5cGU6IFN0cmluZyB9KQ0KICB0ZWFjaG1vZGUhOiBzdHJpbmcNCg0KICBwcml2YXRlIGJhc2VJbmZvRGF0YSE6IElDb3Vyc2VCYXNlSW5mbyAvLyDor77nqIvln7rmnKzkv6Hmga8NCiAgcHJpdmF0ZSBjYXRlZ29yeVRyZWVEYXRhOiBJQ291cnNlQ2F0ZWdvcnlbXSA9IFtdIC8vIOivvueoi+WIhuexuw0KICBwcml2YXRlIGRlZmF1bHRQcm9wcyA9IHsNCiAgICBjaGlsZHJlbjogJ2NoaWxkcmVuVHJlZU5vZGVzJywNCiAgICB2YWx1ZTogJ2lkJywNCiAgICBsYWJlbDogJ2xhYmVsJw0KICB9DQogIC8vIHByaXZhdGUgY2F0ZWdvcnlUcmVlU2VsZWN0ZWQ6IHN0cmluZ1tdID0gWycnLCAnJ10gLy8g6KKr6YCJ5Lit55qE6aG555uuDQogIHByaXZhdGUgZ3JhZGVEYXRhOiBJS1ZEYXRhW10gPSBDT1VTRV9HUkFERV9TVEFUVVMgLy8g6K++56iL562J57qnDQogIHByaXZhdGUgY2hhcmdlRGF0YTogSUtWRGF0YVtdID0gQ09VUlNFX0NIQVJHRV9UWVBFX1NUQVRVUyAvLyDor77nqIvnsbvlnosg5pS26LS5IOWFjei0uQ0KDQogIGNvbnN0cnVjdG9yKCkgew0KICAgIHN1cGVyKCkNCiAgICB0aGlzLmJhc2VJbmZvRGF0YSA9IHsNCiAgICAgIGNoYXJnZTogJzIwMTAwMCcsDQogICAgICBwcmljZTogMCwNCg0KICAgICAgbXQ6ICcnLA0KICAgICAgc3Q6ICcnLA0KICAgICAgbmFtZTogJycsDQogICAgICBwaWM6ICcnLA0KICAgICAgdGVhY2htb2RlOiB0aGlzLnRlYWNobW9kZSwNCiAgICAgIHVzZXJzOiAnJywNCg0KICAgICAgdGFnczogJycsDQogICAgICBncmFkZTogJycsDQogICAgICBvYmplY3RpdmVzOiAnJywNCg0KICAgICAgdWlDYXRlZ29yeVRyZWVTZWxlY3RlZDogW10NCiAgICB9DQogIH0NCg0KICAvLyDor7vlj5bmlbDmja4NCiAgcHVibGljIGFzeW5jIGdldERhdGEoKSB7DQogICAgLy8gYWxlcnQodGhpcy5iYXNlSW5mb0RhdGEucGljKQ0KICAgIGlmICh0aGlzLnN5bmNDb3Vyc2VCYXNlSWQgIT0gMCkgew0KICAgICAgbGV0IGRhdGEgPSBhd2FpdCBnZXRCYXNlSW5mbyh0aGlzLnN5bmNDb3Vyc2VCYXNlSWQpDQogICAgICBkYXRhLnVpQ2F0ZWdvcnlUcmVlU2VsZWN0ZWQgPSBbZGF0YS5tdCwgZGF0YS5zdF0NCiAgICAgIHRoaXMuYmFzZUluZm9EYXRhID0gZGF0YQ0KICAgICAgdGhpcy5iYXNlSW5mb0RhdGEucGljID0gYCR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9TRVJWRVJfUElDU0VSVkVSX1VSTH1gK3RoaXMuYmFzZUluZm9EYXRhLnBpYyAgICANCiAgICB9DQogIH0NCg0KICAvLyDkv53lrZjmlbDmja4NCiAgcHVibGljIGFzeW5jIHNhdmVEYXRhKCk6IFByb21pc2U8Ym9vbGVhbj4gew0KDQogICAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIChyZXNvbHZlLCByZWplY3QpID0+IHsNCiAgICAgIGxldCB2YWxpZDogYm9vbGVhbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVGb3JtKCkNCiAgICAgIGlmICh2YWxpZCkgew0KICAgICAgICAgICAgLy/lm77niYfot6/lvoTljrvmjonnvZHlnYANCiAgICAgICAgdGhpcy5iYXNlSW5mb0RhdGEucGljID0gdGhpcy5iYXNlSW5mb0RhdGEucGljLnJlcGxhY2UoYCR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9TRVJWRVJfUElDU0VSVkVSX1VSTH1gLCcnKQ0KICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0OiBJQ291cnNlQmFzZUluZm8gPSBhd2FpdCBzdWJtaXRCYXNlSW5mbyh0aGlzLmJhc2VJbmZvRGF0YSkNCiAgICAgICAgaWYgKHJlc3VsdC5jb3Vyc2VCYXNlSWQgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgIHRoaXMuc3luY0NvdXJzZUJhc2VJZCA9IHJlc3VsdC5jb3Vyc2VCYXNlSWQNCiAgICAgICAgICByZXNvbHZlKCkNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6K+35q2j56Gu6L6T5YWl6KGo5Y2V5YaF5a65JykNCiAgICAgICAgcmVqZWN0KCkNCiAgICAgIH0NCiAgICB9KQ0KICB9DQoNCiAgLy8g6aqM6K+B6KeE5YiZDQogIHByaXZhdGUgcnVsZXMgPSB7DQogICAgbmFtZTogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXor77nqIvlkI3np7AnLCB0cmlnZ2VyOiAnYmx1cicgfV0sDQogICAgdWlDYXRlZ29yeVRyZWVTZWxlY3RlZDogWw0KICAgICAgew0KICAgICAgICByZXF1aXJlZDogdHJ1ZSwNCiAgICAgICAgbWVzc2FnZTogJ+ivt+mAieaLqeivvueoi+WIhuexuycsDQogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnDQogICAgICB9DQogICAgXSwNCiAgICBjaGFyZ2U6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5pS26LS56KeE5YiZJywgdHJpZ2dlcjogJ2JsdXInIH1dLA0KICAgIGdyYWRlOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeivvueoi+etiee6pycsIHRyaWdnZXI6ICdibHVyJyB9XSwNCiAgICB1c2VyczogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXpgILnlKjkurrnvqQnLCB0cmlnZ2VyOiAnYmx1cicgfV0NCiAgICAvLyBwcmljZTogWw0KICAgIC8vICAgew0KICAgIC8vICAgICByZXF1aXJlZDogdHJ1ZSwNCiAgICAvLyAgICAgbWVzc2FnZTogJ+ivt+ato+ehrui+k+WFpeivvueoi+S7t+agvCcsDQogICAgLy8gICAgIHRyaWdnZXI6ICdjaGFuZ2UnDQogICAgLy8gICB9DQogICAgLy8gXQ0KICB9DQogIHB1YmxpYyB2YWxpZGF0ZUZvcm0oKTogUHJvbWlzZTxib29sZWFuPiB7DQogICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gew0KICAgICAgbGV0IGZvcm06IEVsRm9ybSA9IHRoaXMuJHJlZnNbJ2Zvcm0nXSBhcyBFbEZvcm0NCiAgICAgIGZvcm0udmFsaWRhdGUodmFsaWQgPT4gcmVzb2x2ZSh2YWxpZCkpDQogICAgfSkNCiAgfQ0KDQogIGFzeW5jIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5jYXRlZ29yeVRyZWVEYXRhID0gYXdhaXQgY2F0ZWdvcnkoKQ0KICB9DQoNCiAgLy8g5LqL5Lu2IGhhbmRsZQ0KICBwcml2YXRlIGhhbmRsZUNhdGVnb3J5VHJlZUNoYW5nZShkYXRhKSB7DQogICAgY29uc29sZS5sb2coZGF0YSkNCiAgICB0aGlzLmJhc2VJbmZvRGF0YS5tdCA9IGRhdGFbMF0NCiAgICB0aGlzLmJhc2VJbmZvRGF0YS5zdCA9IGRhdGFbMV0NCiAgfQ0KDQogIC8vIOebkeaOpyB3YXRjaA0KICAvLyDmkJzntKLmoI8NCiAgLy8gQFdhdGNoKCdiYXNlSW5mb0RhdGEnLCB7IGRlZXA6IHRydWUsIGltbWVkaWF0ZTogdHJ1ZSB9KQ0KICAvLyBwcml2YXRlIHdhdGNoTGlzdFF1ZXJ5RGF0YShuZXdWYWw6IElDb3Vyc2VCYXNlSW5mbykgew0KICAvLyAgIGlmIChuZXdWYWwgPT09IHVuZGVmaW5lZCkgew0KICAvLyAgICAgcmV0dXJuDQogIC8vICAgfQ0KICAvLyAgIHRoaXMuY2F0ZWdvcnlUcmVlU2VsZWN0ZWQgPSBbbmV3VmFsLm10LCBuZXdWYWwuc3RdDQogIC8vIH0NCn0NCg=="},{"version":3,"sources":["course-add-step1-base.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"course-add-step1-base.vue","sourceRoot":"src/module-organization/pages/course-manage","sourcesContent":["<template>\r\n  <div class=\"step-body\">\r\n    <el-form\r\n      ref=\"form\"\r\n      v-if=\"baseInfoData\"\r\n      :model=\"baseInfoData\"\r\n      :rules=\"rules\"\r\n      label-width=\"120px\"\r\n    >\r\n      <el-form-item label=\"课程名称：\" prop=\"name\">\r\n        <el-input v-model=\"baseInfoData.name\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程标签：\" prop=\"tags\">\r\n        <el-input v-model=\"baseInfoData.tags\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程分类：\" prop=\"uiCategoryTreeSelected\">\r\n        <el-cascader\r\n          v-if=\"categoryTreeData.length > 0\"\r\n          v-model=\"baseInfoData.uiCategoryTreeSelected\"\r\n          :options=\"categoryTreeData\"\r\n          :props=\"defaultProps\"\r\n          @change=\"handleCategoryTreeChange\"\r\n        ></el-cascader>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程等级：\" prop=\"grade\">\r\n        <el-select v-model=\"baseInfoData.grade\" placeholder=\"请选择\">\r\n          <el-option\r\n            v-for=\"item in gradeData\"\r\n            :key=\"item.code\"\r\n            :label=\"item.desc\"\r\n            :value=\"item.code\"\r\n          ></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程简介：\">\r\n        <el-input v-model=\"baseInfoData.description\" type=\"textarea\" :rows=\"5\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程目标：\">\r\n        <el-input v-model=\"baseInfoData.objectives\" type=\"textarea\" :rows=\"5\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"适用人群：\" prop=\"users\">\r\n        <el-input v-model=\"baseInfoData.users\" type=\"textarea\" :rows=\"5\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程封面：\" prop=\"pic\">\r\n        <common-entering-step2-upload-image :imageUrl.sync=\"baseInfoData.pic\">\r\n          图片要求 点击查看课程封面模版规范\r\n          <br />尺寸大于1080*608 分辨率小于96dpi\r\n        </common-entering-step2-upload-image>\r\n        <!-- <el-input v-model=\"baseInfoData.pic\"></el-input> -->\r\n      </el-form-item>\r\n      <el-form-item label=\"课程类型：\" prop=\"charge\">\r\n        <template v-for=\"item in chargeData\">\r\n          <el-radio :key=\"item.code\" v-model=\"baseInfoData.charge\" :label=\"item.code\">{{item.desc}}</el-radio>\r\n        </template>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程价格：\" prop=\"price\">\r\n        <el-input v-model=\"baseInfoData.price\" style=\"width:150px;\"></el-input>\r\n        <!-- <span>&nbsp;元</span> -->\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script lang=\"ts\">\r\nimport { Component, Prop, PropSync, Watch, Vue } from 'vue-property-decorator'\r\nimport { IKVData } from '@/api/types'\r\nimport { COUSE_GRADE_STATUS, COURSE_CHARGE_TYPE_STATUS } from '@/api/constants'\r\nimport { category, submitBaseInfo, getBaseInfo } from '@/api/courses'\r\nimport { ICourseCategory, ICourseBaseInfo } from '@/entity/course-add-base'\r\nimport { ElForm } from 'element-ui/types/form'\r\nimport CommonEnteringStep2UploadImage from '@/module-entering/pages/entering/components/common-entering-step2-upload-image.vue'\r\n\r\n@Component({\r\n  name: 'CourseAddStep1BaseInfo',\r\n  components: {\r\n    CommonEnteringStep2UploadImage\r\n  }\r\n})\r\nexport default class extends Vue {\r\n  @PropSync('courseBaseId', {})\r\n  syncCourseBaseId!: number\r\n\r\n  @Prop({ type: String })\r\n  teachmode!: string\r\n\r\n  private baseInfoData!: ICourseBaseInfo // 课程基本信息\r\n  private categoryTreeData: ICourseCategory[] = [] // 课程分类\r\n  private defaultProps = {\r\n    children: 'childrenTreeNodes',\r\n    value: 'id',\r\n    label: 'label'\r\n  }\r\n  // private categoryTreeSelected: string[] = ['', ''] // 被选中的项目\r\n  private gradeData: IKVData[] = COUSE_GRADE_STATUS // 课程等级\r\n  private chargeData: IKVData[] = COURSE_CHARGE_TYPE_STATUS // 课程类型 收费 免费\r\n\r\n  constructor() {\r\n    super()\r\n    this.baseInfoData = {\r\n      charge: '201000',\r\n      price: 0,\r\n\r\n      mt: '',\r\n      st: '',\r\n      name: '',\r\n      pic: '',\r\n      teachmode: this.teachmode,\r\n      users: '',\r\n\r\n      tags: '',\r\n      grade: '',\r\n      objectives: '',\r\n\r\n      uiCategoryTreeSelected: []\r\n    }\r\n  }\r\n\r\n  // 读取数据\r\n  public async getData() {\r\n    // alert(this.baseInfoData.pic)\r\n    if (this.syncCourseBaseId != 0) {\r\n      let data = await getBaseInfo(this.syncCourseBaseId)\r\n      data.uiCategoryTreeSelected = [data.mt, data.st]\r\n      this.baseInfoData = data\r\n      this.baseInfoData.pic = `${process.env.VUE_APP_SERVER_PICSERVER_URL}`+this.baseInfoData.pic    \r\n    }\r\n  }\r\n\r\n  // 保存数据\r\n  public async saveData(): Promise<boolean> {\r\n\r\n    return new Promise(async (resolve, reject) => {\r\n      let valid: boolean = await this.validateForm()\r\n      if (valid) {\r\n            //图片路径去掉网址\r\n        this.baseInfoData.pic = this.baseInfoData.pic.replace(`${process.env.VUE_APP_SERVER_PICSERVER_URL}`,'')\r\n               const result: ICourseBaseInfo = await submitBaseInfo(this.baseInfoData)\r\n        if (result.courseBaseId !== undefined) {\r\n          this.syncCourseBaseId = result.courseBaseId\r\n          resolve()\r\n        }\r\n      } else {\r\n        this.$message.error('请正确输入表单内容')\r\n        reject()\r\n      }\r\n    })\r\n  }\r\n\r\n  // 验证规则\r\n  private rules = {\r\n    name: [{ required: true, message: '请输入课程名称', trigger: 'blur' }],\r\n    uiCategoryTreeSelected: [\r\n      {\r\n        required: true,\r\n        message: '请选择课程分类',\r\n        trigger: 'change'\r\n      }\r\n    ],\r\n    charge: [{ required: true, message: '请输入收费规则', trigger: 'blur' }],\r\n    grade: [{ required: true, message: '请输入课程等级', trigger: 'blur' }],\r\n    users: [{ required: true, message: '请输入适用人群', trigger: 'blur' }]\r\n    // price: [\r\n    //   {\r\n    //     required: true,\r\n    //     message: '请正确输入课程价格',\r\n    //     trigger: 'change'\r\n    //   }\r\n    // ]\r\n  }\r\n  public validateForm(): Promise<boolean> {\r\n    return new Promise(resolve => {\r\n      let form: ElForm = this.$refs['form'] as ElForm\r\n      form.validate(valid => resolve(valid))\r\n    })\r\n  }\r\n\r\n  async created() {\r\n    this.categoryTreeData = await category()\r\n  }\r\n\r\n  // 事件 handle\r\n  private handleCategoryTreeChange(data) {\r\n    console.log(data)\r\n    this.baseInfoData.mt = data[0]\r\n    this.baseInfoData.st = data[1]\r\n  }\r\n\r\n  // 监控 watch\r\n  // 搜索栏\r\n  // @Watch('baseInfoData', { deep: true, immediate: true })\r\n  // private watchListQueryData(newVal: ICourseBaseInfo) {\r\n  //   if (newVal === undefined) {\r\n  //     return\r\n  //   }\r\n  //   this.categoryTreeSelected = [newVal.mt, newVal.st]\r\n  // }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.step-body {\r\n  width: 800px;\r\n  margin: 0px auto;\r\n}\r\n</style>"]}]}