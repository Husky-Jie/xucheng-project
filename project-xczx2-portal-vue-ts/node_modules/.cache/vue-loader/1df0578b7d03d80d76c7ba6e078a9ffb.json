{"remainingRequest":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\src\\module-organization\\pages\\course-manage\\course-add-step1-base.vue?vue&type=style&index=0&id=2411f0f0&lang=scss&scoped=true&","dependencies":[{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\src\\module-organization\\pages\\course-manage\\course-add-step1-base.vue","mtime":1662539345432},{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\css-loader\\dist\\cjs.js","mtime":1660903053592},{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1660903053930},{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\postcss-loader\\src\\index.js","mtime":1576202027988},{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1660903055666},{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660903053464},{"path":"D:\\itcast2022\\xc_edu3.0\\code_0\\project-xczx2-portal-vue-ts\\node_modules\\vue-loader\\lib\\index.js","mtime":1660903053930}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5zdGVwLWJvZHkgew0KICB3aWR0aDogODAwcHg7DQogIG1hcmdpbjogMHB4IGF1dG87DQp9DQo="},{"version":3,"sources":["course-add-step1-base.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyMA;AACA;AACA;AACA","file":"course-add-step1-base.vue","sourceRoot":"src/module-organization/pages/course-manage","sourcesContent":["<template>\r\n  <div class=\"step-body\">\r\n    <el-form\r\n      ref=\"form\"\r\n      v-if=\"baseInfoData\"\r\n      :model=\"baseInfoData\"\r\n      :rules=\"rules\"\r\n      label-width=\"120px\"\r\n    >\r\n      <el-form-item label=\"课程名称：\" prop=\"name\">\r\n        <el-input v-model=\"baseInfoData.name\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程标签：\" prop=\"tags\">\r\n        <el-input v-model=\"baseInfoData.tags\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程分类：\" prop=\"uiCategoryTreeSelected\">\r\n        <el-cascader\r\n          v-if=\"categoryTreeData.length > 0\"\r\n          v-model=\"baseInfoData.uiCategoryTreeSelected\"\r\n          :options=\"categoryTreeData\"\r\n          :props=\"defaultProps\"\r\n          @change=\"handleCategoryTreeChange\"\r\n        ></el-cascader>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程等级：\" prop=\"grade\">\r\n        <el-select v-model=\"baseInfoData.grade\" placeholder=\"请选择\">\r\n          <el-option\r\n            v-for=\"item in gradeData\"\r\n            :key=\"item.code\"\r\n            :label=\"item.desc\"\r\n            :value=\"item.code\"\r\n          ></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程简介：\">\r\n        <el-input v-model=\"baseInfoData.description\" type=\"textarea\" :rows=\"5\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程目标：\">\r\n        <el-input v-model=\"baseInfoData.objectives\" type=\"textarea\" :rows=\"5\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"适用人群：\" prop=\"users\">\r\n        <el-input v-model=\"baseInfoData.users\" type=\"textarea\" :rows=\"5\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程封面：\" prop=\"pic\">\r\n        <common-entering-step2-upload-image :imageUrl.sync=\"baseInfoData.pic\">\r\n          图片要求 点击查看课程封面模版规范\r\n          <br />尺寸大于1080*608 分辨率小于96dpi\r\n        </common-entering-step2-upload-image>\r\n        <!-- <el-input v-model=\"baseInfoData.pic\"></el-input> -->\r\n      </el-form-item>\r\n      <el-form-item label=\"课程类型：\" prop=\"charge\">\r\n        <template v-for=\"item in chargeData\">\r\n          <el-radio :key=\"item.code\" v-model=\"baseInfoData.charge\" :label=\"item.code\">{{item.desc}}</el-radio>\r\n        </template>\r\n      </el-form-item>\r\n      <el-form-item label=\"课程价格：\" prop=\"price\">\r\n        <el-input v-model=\"baseInfoData.price\" style=\"width:150px;\"></el-input>\r\n        <!-- <span>&nbsp;元</span> -->\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script lang=\"ts\">\r\nimport { Component, Prop, PropSync, Watch, Vue } from 'vue-property-decorator'\r\nimport { IKVData } from '@/api/types'\r\nimport { COUSE_GRADE_STATUS, COURSE_CHARGE_TYPE_STATUS } from '@/api/constants'\r\nimport { category, submitBaseInfo, getBaseInfo } from '@/api/courses'\r\nimport { ICourseCategory, ICourseBaseInfo } from '@/entity/course-add-base'\r\nimport { ElForm } from 'element-ui/types/form'\r\nimport CommonEnteringStep2UploadImage from '@/module-entering/pages/entering/components/common-entering-step2-upload-image.vue'\r\n\r\n@Component({\r\n  name: 'CourseAddStep1BaseInfo',\r\n  components: {\r\n    CommonEnteringStep2UploadImage\r\n  }\r\n})\r\nexport default class extends Vue {\r\n  @PropSync('courseBaseId', {})\r\n  syncCourseBaseId!: number\r\n\r\n  @Prop({ type: String })\r\n  teachmode!: string\r\n\r\n  private baseInfoData!: ICourseBaseInfo // 课程基本信息\r\n  private categoryTreeData: ICourseCategory[] = [] // 课程分类\r\n  private defaultProps = {\r\n    children: 'childrenTreeNodes',\r\n    value: 'id',\r\n    label: 'label'\r\n  }\r\n  // private categoryTreeSelected: string[] = ['', ''] // 被选中的项目\r\n  private gradeData: IKVData[] = COUSE_GRADE_STATUS // 课程等级\r\n  private chargeData: IKVData[] = COURSE_CHARGE_TYPE_STATUS // 课程类型 收费 免费\r\n\r\n  constructor() {\r\n    super()\r\n    this.baseInfoData = {\r\n      charge: '201000',\r\n      price: 0,\r\n\r\n      mt: '',\r\n      st: '',\r\n      name: '',\r\n      pic: '',\r\n      teachmode: this.teachmode,\r\n      users: '',\r\n\r\n      tags: '',\r\n      grade: '',\r\n      objectives: '',\r\n\r\n      uiCategoryTreeSelected: []\r\n    }\r\n  }\r\n\r\n  // 读取数据\r\n  public async getData() {\r\n    // alert(this.baseInfoData.pic)\r\n    if (this.syncCourseBaseId != 0) {\r\n      let data = await getBaseInfo(this.syncCourseBaseId)\r\n      data.uiCategoryTreeSelected = [data.mt, data.st]\r\n      this.baseInfoData = data\r\n      this.baseInfoData.pic = `${process.env.VUE_APP_SERVER_PICSERVER_URL}`+this.baseInfoData.pic    \r\n    }\r\n  }\r\n\r\n  // 保存数据\r\n  public async saveData(): Promise<boolean> {\r\n\r\n    return new Promise(async (resolve, reject) => {\r\n      let valid: boolean = await this.validateForm()\r\n      if (valid) {\r\n            //图片路径去掉网址\r\n        this.baseInfoData.pic = this.baseInfoData.pic.replace(`${process.env.VUE_APP_SERVER_PICSERVER_URL}`,'')\r\n               const result: ICourseBaseInfo = await submitBaseInfo(this.baseInfoData)\r\n        if (result.courseBaseId !== undefined) {\r\n          this.syncCourseBaseId = result.courseBaseId\r\n          resolve()\r\n        }\r\n      } else {\r\n        this.$message.error('请正确输入表单内容')\r\n        reject()\r\n      }\r\n    })\r\n  }\r\n\r\n  // 验证规则\r\n  private rules = {\r\n    name: [{ required: true, message: '请输入课程名称', trigger: 'blur' }],\r\n    uiCategoryTreeSelected: [\r\n      {\r\n        required: true,\r\n        message: '请选择课程分类',\r\n        trigger: 'change'\r\n      }\r\n    ],\r\n    charge: [{ required: true, message: '请输入收费规则', trigger: 'blur' }],\r\n    grade: [{ required: true, message: '请输入课程等级', trigger: 'blur' }],\r\n    users: [{ required: true, message: '请输入适用人群', trigger: 'blur' }]\r\n    // price: [\r\n    //   {\r\n    //     required: true,\r\n    //     message: '请正确输入课程价格',\r\n    //     trigger: 'change'\r\n    //   }\r\n    // ]\r\n  }\r\n  public validateForm(): Promise<boolean> {\r\n    return new Promise(resolve => {\r\n      let form: ElForm = this.$refs['form'] as ElForm\r\n      form.validate(valid => resolve(valid))\r\n    })\r\n  }\r\n\r\n  async created() {\r\n    this.categoryTreeData = await category()\r\n  }\r\n\r\n  // 事件 handle\r\n  private handleCategoryTreeChange(data) {\r\n    console.log(data)\r\n    this.baseInfoData.mt = data[0]\r\n    this.baseInfoData.st = data[1]\r\n  }\r\n\r\n  // 监控 watch\r\n  // 搜索栏\r\n  // @Watch('baseInfoData', { deep: true, immediate: true })\r\n  // private watchListQueryData(newVal: ICourseBaseInfo) {\r\n  //   if (newVal === undefined) {\r\n  //     return\r\n  //   }\r\n  //   this.categoryTreeSelected = [newVal.mt, newVal.st]\r\n  // }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.step-body {\r\n  width: 800px;\r\n  margin: 0px auto;\r\n}\r\n</style>"]}]}