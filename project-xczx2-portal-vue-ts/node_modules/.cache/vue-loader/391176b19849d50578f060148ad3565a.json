{"remainingRequest":"D:\\Java学习\\xucheng-project\\project-xczx2-portal-vue-ts\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Java学习\\xucheng-project\\project-xczx2-portal-vue-ts\\src\\module-organization\\pages\\course-comment-manage\\course-comment-list.vue?vue&type=script&lang=ts&","dependencies":[{"path":"D:\\Java学习\\xucheng-project\\project-xczx2-portal-vue-ts\\src\\module-organization\\pages\\course-comment-manage\\course-comment-list.vue","mtime":1610853292273},{"path":"D:\\Java学习\\xucheng-project\\project-xczx2-portal-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660903053464},{"path":"D:\\Java学习\\xucheng-project\\project-xczx2-portal-vue-ts\\node_modules\\babel-loader\\lib\\index.js","mtime":1576202003988},{"path":"D:\\Java学习\\xucheng-project\\project-xczx2-portal-vue-ts\\node_modules\\ts-loader\\index.js","mtime":1660903053026},{"path":"D:\\Java学习\\xucheng-project\\project-xczx2-portal-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660903053464},{"path":"D:\\Java学习\\xucheng-project\\project-xczx2-portal-vue-ts\\node_modules\\vue-loader\\lib\\index.js","mtime":1660903053930}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQppbXBvcnQgeyBDb21wb25lbnQsIFZ1ZSwgV2F0Y2ggfSBmcm9tICd2dWUtcHJvcGVydHktZGVjb3JhdG9yJw0KaW1wb3J0IFBhZ2luYXRpb24gZnJvbSAnQC9jb21wb25lbnRzL3BhZ2luYXRpb24vaW5kZXgudnVlJw0KaW1wb3J0IHsNCiAgSUNvdXJzZUNvbW1lbnRQYWdlVk8sDQogIElDb21tZW50RFRPDQp9IGZyb20gJ0AvZW50aXR5L2NvdXJzZS1jb21tZW50LXBhZ2UtbGlzdCcNCmltcG9ydCB7DQogIGdldENvdXJzZUNvbW1lbnRQYWdlTGlzdCwNCiAgcmVwbHlDb3Vyc2VDb21tZW50DQp9IGZyb20gJ0AvYXBpL2NvdXJzZS1jb21tZW50Jw0KDQpAQ29tcG9uZW50KHsNCiAgY29tcG9uZW50czogew0KICAgIFBhZ2luYXRpb24NCiAgfQ0KfSkNCmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvdXJzZUNvbW1lbnRMaXN0IGV4dGVuZHMgVnVlIHsNCiAgLy8g5piv5ZCm6L295YWl5LitDQogIHByaXZhdGUgbGlzdExvYWRpbmc6IGJvb2xlYW4gPSBmYWxzZQ0KICAvLyDor7fmsYLlj4LmlbBRdWVyeQ0KICBwcml2YXRlIGxpc3RRdWVyeSA9IHsNCiAgICBwYWdlTm86IDEsDQogICAgcGFnZVNpemU6IDEwDQogIH0NCiAgLy8g6K+35rGC5Y+C5pWwYm9keQ0KICBwcml2YXRlIGxpc3RRdWVyeURhdGEgPSB7DQogICAgdGFyZ2V0TmFtZTogJycsDQogICAgbGV2ZWw6IDINCiAgfQ0KICAvLyDor4TorrrliJfooagNCiAgcHJpdmF0ZSBsaXN0UmVzdWx0OiBJQ291cnNlQ29tbWVudFBhZ2VWTyA9IHt9DQoNCiAgLy8g6K6h566X5bGe5oCnDQogIGdldFJlcGx5U3RhdHVzKGNvbW1lbnQ6IGFueSkgew0KICAgIGlmIChjb21tZW50LnJlcGx5RFRPTGlzdCAmJiBjb21tZW50LnJlcGx5RFRPTGlzdC5sZW5ndGggPiAwKSB7DQogICAgICByZXR1cm4gJ+W3suWbnuWkjScNCiAgICB9DQogICAgcmV0dXJuICFjb21tZW50LnNob3dSZXBseVRleHRhcmVhID8gJ+WbnuWkjScgOiAn5Y+W5raI5Zue5aSNJw0KICB9DQoNCiAgLyoqDQogICAqIOivhOiuuuWIl+ihqA0KICAgKi8NCiAgcHJpdmF0ZSBhc3luYyBnZXRDb3Vyc2VDb21tZW50UGFnZUxpc3QoKSB7DQogICAgdGhpcy5saXN0TG9hZGluZyA9IHRydWUNCiAgICBsZXQgdGVtcFF1ZXJ5RGF0YTogYW55ID0ge30NCiAgICBpZiAodGhpcy5saXN0UXVlcnlEYXRhLnRhcmdldE5hbWUpIHsNCiAgICAgIHRlbXBRdWVyeURhdGEudGFyZ2V0TmFtZSA9IHRoaXMubGlzdFF1ZXJ5RGF0YS50YXJnZXROYW1lDQogICAgfQ0KICAgIGlmICh0aGlzLmxpc3RRdWVyeURhdGEubGV2ZWwgIT0gMikgew0KICAgICAgdGVtcFF1ZXJ5RGF0YS5sZXZlbCA9IHRoaXMubGlzdFF1ZXJ5RGF0YS5sZXZlbA0KICAgIH0NCiAgICBsZXQgbGlzdFJlc3VsdDogSUNvdXJzZUNvbW1lbnRQYWdlVk8gPSBhd2FpdCBnZXRDb3Vyc2VDb21tZW50UGFnZUxpc3QoDQogICAgICB0aGlzLmxpc3RRdWVyeSwNCiAgICAgIHRlbXBRdWVyeURhdGENCiAgICApDQogICAgaWYgKGxpc3RSZXN1bHQgJiYgbGlzdFJlc3VsdC5pdGVtcykgew0KICAgICAgbGlzdFJlc3VsdC5pdGVtcyA9IGxpc3RSZXN1bHQuaXRlbXMubWFwKChpdGVtOiBhbnkpID0+IHsNCiAgICAgICAgaXRlbS5zaG93UmVwbHlUZXh0YXJlYSA9IGZhbHNlDQogICAgICAgIGl0ZW0ubXlSZXBseVRleHQgPSAnJw0KICAgICAgICByZXR1cm4gaXRlbQ0KICAgICAgfSkNCiAgICB9DQogICAgdGhpcy5saXN0UmVzdWx0ID0gbGlzdFJlc3VsdA0KICAgIHRoaXMubGlzdExvYWRpbmcgPSBmYWxzZQ0KICB9DQoNCiAgLyoqDQogICAqIOWbnuWkjS/lj5bmtojlm57lpI0NCiAgICovDQogIHByaXZhdGUgaGFuZGxlU2hvd1JlcGx5VGV4dGFyZWEoY29tbWVudDogYW55KSB7DQogICAgY29tbWVudC5zaG93UmVwbHlUZXh0YXJlYSA9ICFjb21tZW50LnNob3dSZXBseVRleHRhcmVhDQogIH0NCg0KICAvKioNCiAgICog5Y+R6KGo5Zue5aSNDQogICAqLw0KICBwcml2YXRlIGFzeW5jIGhhbmRsZVJlcGx5Q291cnNlQ29tbWVudChjb21tZW50OiBhbnkpIHsNCiAgICBsZXQgYm9keSA9IHsNCiAgICAgIGNvbW1lbnRJZDogY29tbWVudC5jb21tZW50SWQsDQogICAgICByZXBseVRleHQ6IGNvbW1lbnQubXlSZXBseVRleHQNCiAgICB9DQogICAgLy8g5o+Q5Lqk6KGo5Y2VDQogICAgYXdhaXQgcmVwbHlDb3Vyc2VDb21tZW50KGJvZHkpDQoNCiAgICAvLyDnlKjmiLfmj5DnpLoNCiAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+WPkeW4g+WbnuWkjeaIkOWKnycpDQogICAgY29tbWVudC5zaG93UmVwbHlUZXh0YXJlYSA9IGZhbHNlDQogICAgY29tbWVudC5teVJlcGx5VGV4dCA9ICcnDQoNCiAgICAvLyDliLfmlrDliJfooagNCiAgICB0aGlzLmdldENvdXJzZUNvbW1lbnRQYWdlTGlzdCgpDQogIH0NCg0KICAvLyDnm5Hmjqcgd2F0Y2gNCiAgLy8g5pCc57Si5qCPDQogIEBXYXRjaCgnbGlzdFF1ZXJ5RGF0YScsIHsgZGVlcDogdHJ1ZSwgaW1tZWRpYXRlOiB0cnVlIH0pDQogIHByaXZhdGUgd2F0Y2hMaXN0UXVlcnlEYXRhKG5ld1ZhbDogc3RyaW5nKSB7DQogICAgaWYgKG5ld1ZhbCA9PSAnJykgew0KICAgICAgcmV0dXJuDQogICAgfQ0KICAgIHRoaXMuZ2V0Q291cnNlQ29tbWVudFBhZ2VMaXN0KCkNCiAgfQ0KDQogIC8vIOe/u+mhtSBwYWdlU2l6ZQ0KICBAV2F0Y2goJ2xpc3RRdWVyeS5wYWdlU2l6ZScsIHsgaW1tZWRpYXRlOiB0cnVlIH0pDQogIHByaXZhdGUgd2F0Y2hMaXN0UXVlcnlQYWdlU2l6ZShuZXdWYWw6IG51bWJlcikgew0KICAgIHRoaXMubGlzdFF1ZXJ5LnBhZ2VObyA9IDENCiAgfQ0KfQ0K"},{"version":3,"sources":["course-comment-list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"course-comment-list.vue","sourceRoot":"src/module-organization/pages/course-comment-manage","sourcesContent":["<template>\r\n  <div class=\"course-list portal-content\">\r\n    <div class=\"workspace\">\r\n      <div class=\"banner\">\r\n        <span class=\"primary-title\">评价管理</span>\r\n      </div>\r\n\r\n      <!-- 搜索栏 -->\r\n      <div class=\"searcher\">\r\n        <el-input\r\n          class=\"el-input\"\r\n          placeholder=\"请输入课程名称\"\r\n          suffix-icon=\"el-icon-search\"\r\n          v-model=\"listQueryData.targetName\"\r\n        />\r\n        <el-radio-group v-model=\"listQueryData.level\">\r\n          <el-radio :label=\"2\">全部评价</el-radio>\r\n          <el-radio :label=\"1\">好评</el-radio>\r\n          <el-radio :label=\"0\">中评</el-radio>\r\n          <el-radio :label=\"-1\">差评</el-radio>\r\n        </el-radio-group>\r\n      </div>\r\n\r\n      <!-- 数据列表 -->\r\n      <!-- TODO: 拆成组件 -->\r\n      <div class=\"dataList\">\r\n        <el-row\r\n          :gutter=\"10\"\r\n          v-for=\"(comment, index) in listResult.items\"\r\n          :key=\"index\"\r\n          class=\"course-comment\"\r\n        >\r\n          <el-col :span=\"1\">\r\n            <img :src=\"comment.userHead\" class=\"user-head\" />\r\n          </el-col>\r\n          <el-col :span=\"23\">\r\n            <el-row>\r\n              <el-col :span=\"24\">\r\n                <el-rate v-model=\"comment.starRank\" disabled></el-rate>\r\n              </el-col>\r\n              <el-col :span=\"24\">\r\n                <el-row>\r\n                  <el-col :span=\"23\" class=\"comment-text\">{{ comment.commentText }}</el-col>\r\n                  <el-col :span=\"1\">\r\n                    <el-button\r\n                      type=\"text\"\r\n                      size=\"mini\"\r\n                      @click=\"handleShowReplyTextarea(comment)\"\r\n                    >{{ getReplyStatus(comment) }}</el-button>\r\n                  </el-col>\r\n                </el-row>\r\n              </el-col>\r\n              <el-col\r\n                :span=\"24\"\r\n                class=\"come-from\"\r\n              >已上课10小时 评价来自《{{ comment.comeFrom }}》 {{ comment.commentDate | dateTimeFormat }} 举报</el-col>\r\n              <el-col\r\n                :span=\"24\"\r\n                class=\"comment-reply\"\r\n                v-if=\"comment.replyDTOList && comment.replyDTOList.length\"\r\n              >\r\n                <el-row\r\n                  v-for=\"(reply, subIndex) in comment.replyDTOList\"\r\n                  :key=\"subIndex\"\r\n                  class=\"reply-item\"\r\n                >\r\n                  <el-col :span=\"24\" class=\"reply-text\">{{ reply.nickName }}回复：{{ reply.replyText }}</el-col>\r\n                  <el-col :span=\"24\" class=\"reply-date\">{{ reply.replyDate | dateTimeFormat }}</el-col>\r\n                </el-row>\r\n              </el-col>\r\n              <el-col :span=\"24\" v-if=\"comment.showReplyTextarea\" class=\"my-reply-text\">\r\n                <el-input\r\n                  type=\"textarea\"\r\n                  :rows=\"5\"\r\n                  v-model=\"comment.myReplyText\"\r\n                  placeholder\r\n                  maxlength=\"200\"\r\n                  show-word-limit\r\n                ></el-input>\r\n              </el-col>\r\n              <el-col :span=\"24\" v-if=\"comment.showReplyTextarea\" class=\"reply-button\">\r\n                <el-button\r\n                  type=\"primary\"\r\n                  size=\"medium\"\r\n                  class=\"btn-add el-button\"\r\n                  :disabled=\"!comment.myReplyText\"\r\n                  @click=\"handleReplyCourseComment(comment)\"\r\n                >发表回复</el-button>\r\n              </el-col>\r\n            </el-row>\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n\r\n      <!-- 翻页控制 -->\r\n      <div class=\"dataList-pagination\">\r\n        <Pagination\r\n          v-show=\"listResult.counts > 0\"\r\n          :total=\"listResult.counts\"\r\n          :page.sync=\"listQuery.pageNo\"\r\n          :limit.sync=\"listQuery.pageSize\"\r\n          @pagination=\"getCourseCommentPageList\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { Component, Vue, Watch } from 'vue-property-decorator'\r\nimport Pagination from '@/components/pagination/index.vue'\r\nimport {\r\n  ICourseCommentPageVO,\r\n  ICommentDTO\r\n} from '@/entity/course-comment-page-list'\r\nimport {\r\n  getCourseCommentPageList,\r\n  replyCourseComment\r\n} from '@/api/course-comment'\r\n\r\n@Component({\r\n  components: {\r\n    Pagination\r\n  }\r\n})\r\nexport default class CourseCommentList extends Vue {\r\n  // 是否载入中\r\n  private listLoading: boolean = false\r\n  // 请求参数Query\r\n  private listQuery = {\r\n    pageNo: 1,\r\n    pageSize: 10\r\n  }\r\n  // 请求参数body\r\n  private listQueryData = {\r\n    targetName: '',\r\n    level: 2\r\n  }\r\n  // 评论列表\r\n  private listResult: ICourseCommentPageVO = {}\r\n\r\n  // 计算属性\r\n  getReplyStatus(comment: any) {\r\n    if (comment.replyDTOList && comment.replyDTOList.length > 0) {\r\n      return '已回复'\r\n    }\r\n    return !comment.showReplyTextarea ? '回复' : '取消回复'\r\n  }\r\n\r\n  /**\r\n   * 评论列表\r\n   */\r\n  private async getCourseCommentPageList() {\r\n    this.listLoading = true\r\n    let tempQueryData: any = {}\r\n    if (this.listQueryData.targetName) {\r\n      tempQueryData.targetName = this.listQueryData.targetName\r\n    }\r\n    if (this.listQueryData.level != 2) {\r\n      tempQueryData.level = this.listQueryData.level\r\n    }\r\n    let listResult: ICourseCommentPageVO = await getCourseCommentPageList(\r\n      this.listQuery,\r\n      tempQueryData\r\n    )\r\n    if (listResult && listResult.items) {\r\n      listResult.items = listResult.items.map((item: any) => {\r\n        item.showReplyTextarea = false\r\n        item.myReplyText = ''\r\n        return item\r\n      })\r\n    }\r\n    this.listResult = listResult\r\n    this.listLoading = false\r\n  }\r\n\r\n  /**\r\n   * 回复/取消回复\r\n   */\r\n  private handleShowReplyTextarea(comment: any) {\r\n    comment.showReplyTextarea = !comment.showReplyTextarea\r\n  }\r\n\r\n  /**\r\n   * 发表回复\r\n   */\r\n  private async handleReplyCourseComment(comment: any) {\r\n    let body = {\r\n      commentId: comment.commentId,\r\n      replyText: comment.myReplyText\r\n    }\r\n    // 提交表单\r\n    await replyCourseComment(body)\r\n\r\n    // 用户提示\r\n    this.$message.success('发布回复成功')\r\n    comment.showReplyTextarea = false\r\n    comment.myReplyText = ''\r\n\r\n    // 刷新列表\r\n    this.getCourseCommentPageList()\r\n  }\r\n\r\n  // 监控 watch\r\n  // 搜索栏\r\n  @Watch('listQueryData', { deep: true, immediate: true })\r\n  private watchListQueryData(newVal: string) {\r\n    if (newVal == '') {\r\n      return\r\n    }\r\n    this.getCourseCommentPageList()\r\n  }\r\n\r\n  // 翻页 pageSize\r\n  @Watch('listQuery.pageSize', { immediate: true })\r\n  private watchListQueryPageSize(newVal: number) {\r\n    this.listQuery.pageNo = 1\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.course-list {\r\n  .nav-bar {\r\n    margin-top: 16px;\r\n  }\r\n\r\n  .workspace .banner .btn-add {\r\n    float: right;\r\n  }\r\n\r\n  .searcher {\r\n    margin-top: 16px;\r\n\r\n    .el-input {\r\n      width: 218px;\r\n      margin-right: 40px;\r\n    }\r\n    // div {\r\n    //   width: 218px;\r\n    //   margin-right: 10px;\r\n    // }\r\n  }\r\n\r\n  .dataList {\r\n    margin-top: 16px;\r\n\r\n    .course-comment {\r\n      padding: 20px 0;\r\n      border-top: 1px solid #ededed;\r\n\r\n      .user-head {\r\n        width: 100%;\r\n        margin-top: 10px;\r\n        border-radius: 50%;\r\n      }\r\n\r\n      .comment-text {\r\n        color: #333333;\r\n      }\r\n\r\n      .come-from {\r\n        color: #999999;\r\n        font-size: 12px;\r\n      }\r\n\r\n      .comment-reply {\r\n        margin-top: 20px;\r\n        padding: 15px 14px 5px 14px;\r\n        background-color: #f8f8f8;\r\n\r\n        .reply-item {\r\n          margin-bottom: 10px;\r\n\r\n          .reply-text {\r\n            color: #666666;\r\n          }\r\n\r\n          .reply-date {\r\n            margin-top: 5px;\r\n            color: #999999;\r\n            font-size: 12px;\r\n          }\r\n        }\r\n      }\r\n\r\n      .my-reply-text {\r\n        margin-top: 25px;\r\n      }\r\n\r\n      .reply-button {\r\n        margin-top: 10px;\r\n        text-align: right;\r\n      }\r\n    }\r\n\r\n    .course-comment:last-child {\r\n      border-bottom: 1px solid #ededed;\r\n    }\r\n  }\r\n\r\n  .dataList-pagination {\r\n    text-align: center;\r\n    width: 100%;\r\n  }\r\n}\r\n</style>\r\n"]}]}