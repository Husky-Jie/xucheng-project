{"remainingRequest":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\src\\module-organization\\pages\\media-manage\\components\\upload-bigfile.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\src\\module-organization\\pages\\media-manage\\components\\upload-bigfile.vue","mtime":1661399971175},{"path":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660903053464},{"path":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\node_modules\\babel-loader\\lib\\index.js","mtime":1576202003988},{"path":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660903053464},{"path":"E:\\course\\2022\\学成在线\\front_code\\project-xczx2-portal-vue-ts\\node_modules\\vue-loader\\lib\\index.js","mtime":1660903053930}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCiAgaW1wb3J0ICQgZnJvbSAnLi4vLi4vLi4vLi4vLi4vc3RhdGljL3BsdWdpbnMvanF1ZXJ5L2Rpc3QvanF1ZXJ5LmpzJwogIGltcG9ydCB3ZWJ1cGxvYWRlciBmcm9tICcuLi8uLi8uLi8uLi8uLi9zdGF0aWMvcGx1Z2lucy93ZWJ1cGxvYWRlci9kaXN0L3dlYnVwbG9hZGVyLmpzJwogIGltcG9ydCAnLi4vLi4vLi4vLi4vLi4vc3RhdGljL2Nzcy93ZWJ1cGxvYWRlci93ZWJ1cGxvYWRlci5jc3MnCiAgZXhwb3J0IGRlZmF1bHR7CiAgICBkYXRhKCl7CiAgICAgIHJldHVybnsKICAgICAgICB1cGxvYWRlcjp7fSwKICAgICAgICB1cGxvYWRGaWxlOnt9LAogICAgICAgIHBlcmNlbnRhZ2U6MCwKICAgICAgICBmaWxlTWQ1OicnCiAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOnsKICAgICAgLy/lvIDlp4vkuIrkvKAKICAgICAgdXBsb2FkKCl7CiAgICAgICAgaWYodGhpcy51cGxvYWRGaWxlICYmIHRoaXMudXBsb2FkRmlsZS5pZCl7CiAgICAgICAgICB0aGlzLnVwbG9hZGVyLnVwbG9hZCh0aGlzLnVwbG9hZEZpbGUuaWQpOwogICAgICAgIH1lbHNlewogICAgICAgICAgYWxlcnQoIuivt+mAieaLqeaWh+S7tiIpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIG1vdW50ZWQoKXsKLy8gICAgICB2YXIgZmlsZU1kNTsKLy8gICAgICB2YXIgdXBsb2FkRmlsZTsKICAgICAgV2ViVXBsb2FkZXIuVXBsb2FkZXIucmVnaXN0ZXIoewogICAgICAgICAgImJlZm9yZS1zZW5kLWZpbGUiOiJiZWZvcmVTZW5kRmlsZSIsCiAgICAgICAgICAiYmVmb3JlLXNlbmQiOiJiZWZvcmVTZW5kIiwKICAgICAgICAgICJhZnRlci1zZW5kLWZpbGUiOiJhZnRlclNlbmRGaWxlIgogICAgICAgIH0sewogICAgICAgICAgYmVmb3JlU2VuZEZpbGU6ZnVuY3Rpb24oZmlsZSkgewogICAgICAgICAgICAvLyDliJvlu7rkuIDkuKpkZWZmZXJlZCznlKjkuo7pgJrnn6XmmK/lkKblrozmiJDmk43kvZwKICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gV2ViVXBsb2FkZXIuRGVmZXJyZWQoKTsKICAgICAgICAgICAgLy8g6K6h566X5paH5Lu255qE5ZSv5LiA5qCH6K+G77yM55So5LqO5pat54K557ut5LygCiAgICAgICAgICAgIChuZXcgV2ViVXBsb2FkZXIuVXBsb2FkZXIoKSkubWQ1RmlsZShmaWxlLCAwLCAxMDAqMTAyNCoxMDI0KQogICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHZhbCkgewoKICAgICAgICAgICAgICAgIHRoaXMuZmlsZU1kNSA9IHZhbDsKICAgICAgICAgICAgICAgIHRoaXMudXBsb2FkRmlsZSA9IGZpbGU7CiAgICAgICAgICAgICAgICAvL2FsZXJ0KGZpbGVNZDUgKQogICAgICAgICAgICAgICAgLy/lkJHmnI3liqHnq6/or7fmsYLms6jlhozkuIrkvKDmlofku7YKICAgICAgICAgICAgICAgICQuYWpheCgKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHR5cGU6IlBPU1QiLAogICAgICAgICAgICAgICAgICAgIHVybDoiL2FwaS9tZWRpYS91cGxvYWQvcmVnaXN0ZXIiLAogICAgICAgICAgICAgICAgICAgIGRhdGE6ewogICAgICAgICAgICAgICAgICAgICAgLy8g5paH5Lu25ZSv5LiA6KGo56S6CiAgICAgICAgICAgICAgICAgICAgICBmaWxlTWQ1OnRoaXMuZmlsZU1kNSwKICAgICAgICAgICAgICAgICAgICAgIGZpbGVOYW1lOiBmaWxlLm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICBmaWxlU2l6ZTpmaWxlLnNpemUsCiAgICAgICAgICAgICAgICAgICAgICBtaW1ldHlwZTpmaWxlLnR5cGUsCiAgICAgICAgICAgICAgICAgICAgICBmaWxlRXh0OmZpbGUuZXh0CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZToianNvbiIsCiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczpmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgICAgaWYocmVzcG9uc2Uuc3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KCfkuIrkvKDmlofku7bms6jlhozmiJDlip/lvIDlp4vkuIrkvKAnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpOwogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQocmVzcG9uc2UubWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9LmJpbmQodGhpcykpOwoKICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTsKICAgICAgICAgIH0uYmluZCh0aGlzKSwKICAgICAgICAgIGJlZm9yZVNlbmQ6ZnVuY3Rpb24oYmxvY2spIHsKICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gV2ViVXBsb2FkZXIuRGVmZXJyZWQoKTsKICAgICAgICAgICAgLy8g5q+P5qyh5LiK5Lyg5YiG5Z2X5YmN5qCh6aqM5YiG5Z2X77yM5aaC5p6c5bey5a2Y5Zyo5YiG5Z2X5YiZ5LiN5YaN5LiK5Lyg77yM6L6+5Yiw5pat54K557ut5Lyg55qE55uu55qECiAgICAgICAgICAgICQuYWpheCgKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0eXBlOiJQT1NUIiwKICAgICAgICAgICAgICAgIHVybDoiL2FwaS9tZWRpYS91cGxvYWQvY2hlY2tjaHVuayIsCiAgICAgICAgICAgICAgICBkYXRhOnsKICAgICAgICAgICAgICAgICAgLy8g5paH5Lu25ZSv5LiA6KGo56S6CiAgICAgICAgICAgICAgICAgIGZpbGVNZDU6dGhpcy5maWxlTWQ1LAogICAgICAgICAgICAgICAgICAvLyDlvZPliY3liIblnZfkuIvmoIcKICAgICAgICAgICAgICAgICAgY2h1bms6YmxvY2suY2h1bmssCiAgICAgICAgICAgICAgICAgIC8vIOW9k+WJjeWIhuWdl+Wkp+WwjwogICAgICAgICAgICAgICAgICBjaHVua1NpemU6YmxvY2suZW5kLWJsb2NrLnN0YXJ0CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZGF0YVR5cGU6Impzb24iLAogICAgICAgICAgICAgICAgc3VjY2VzczpmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICBpZihyZXNwb25zZS5pZkV4aXN0KSB7CiAgICAgICAgICAgICAgICAgICAgLy8g5YiG5Z2X5a2Y5Zyo77yM6Lez6L+H6K+l5YiG5Z2XCiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8g5YiG5Z2X5LiN5a2Y5Zyo5oiW5LiN5a6M5pW077yM6YeN5paw5Y+R6YCBCiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICApOwogICAgICAgICAgICAvL+aehOW7umZpbGVNZDXlj4LmlbDvvIzkuIrkvKDliIblnZfml7bluKbkuIpmaWxlTWQ1CiAgICAgICAgICAgIHRoaXMudXBsb2FkZXIub3B0aW9ucy5mb3JtRGF0YS5maWxlTWQ1ID0gdGhpcy5maWxlTWQ1OwogICAgICAgICAgICB0aGlzLnVwbG9hZGVyLm9wdGlvbnMuZm9ybURhdGEuY2h1bmsgPSBibG9jay5jaHVuazsKICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTsKICAgICAgICAgIH0uYmluZCh0aGlzKSwKICAgICAgICAgIGFmdGVyU2VuZEZpbGU6ZnVuY3Rpb24oZmlsZSkgewogICAgICAgICAgICAvLyDlkIjlubbliIblnZcKICAgICAgICAgICAgJC5hamF4KAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHR5cGU6IlBPU1QiLAogICAgICAgICAgICAgICAgdXJsOiIvYXBpL21lZGlhL3VwbG9hZC9tZXJnZWNodW5rcyIsCiAgICAgICAgICAgICAgICBkYXRhOnsKICAgICAgICAgICAgICAgICAgZmlsZU1kNTp0aGlzLmZpbGVNZDUsCiAgICAgICAgICAgICAgICAgIGZpbGVOYW1lOiBmaWxlLm5hbWUsCiAgICAgICAgICAgICAgICAgIGZpbGVTaXplOmZpbGUuc2l6ZSwKICAgICAgICAgICAgICAgICAgbWltZXR5cGU6ZmlsZS50eXBlLAogICAgICAgICAgICAgICAgICBmaWxlRXh0OmZpbGUuZXh0CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgc3VjY2VzczpmdW5jdGlvbihyZXNwb25zZSl7CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgKTsKICAgICAgICAgIH0uYmluZCh0aGlzKQogICAgICAgIH0KICAgICAgKTsKICAgICAgLy8g5Yib5bu6dXBsb2FkZXLlr7nosaHvvIzphY3nva7lj4LmlbAKICAgICAgdGhpcy51cGxvYWRlciA9IFdlYlVwbG9hZGVyLmNyZWF0ZSgKICAgICAgICB7CiAgICAgICAgICBzd2Y6Ii9zdGF0aWMvcGx1Z2lucy93ZWJ1cGxvYWRlci9kaXN0L1VwbG9hZGVyLnN3ZiIsLy/kuIrkvKDmlofku7bnmoRmbGFzaOaWh+S7tu+8jOa1j+iniOWZqOS4jeaUr+aMgWg15pe25ZCv5YqoZmxhc2gKICAgICAgICAgIHNlcnZlcjoiL2FwaS9tZWRpYS91cGxvYWQvdXBsb2FkY2h1bmsiLC8v5LiK5Lyg5YiG5Z2X55qE5pyN5Yqh56uv5Zyw5Z2A77yM5rOo5oSP6Leo5Z+f6Zeu6aKYCiAgICAgICAgICBmaWxlVmFsOiJmaWxlIiwvL+aWh+S7tuS4iuS8oOWfn+eahG5hbWUKICAgICAgICAgIHBpY2s6IiNwaWNrZXIiLC8v5oyH5a6a6YCJ5oup5paH5Lu255qE5oyJ6ZKu5a655ZmoCiAgICAgICAgICBhdXRvOmZhbHNlLC8v5omL5Yqo6Kem5Y+R5LiK5LygCiAgICAgICAgICBkaXNhYmxlR2xvYmFsRG5kOnRydWUsLy/npoHmjonmlbTkuKrpobXpnaLnmoTmi5bmi73lip/og70KICAgICAgICAgIGNodW5rZWQ6dHJ1ZSwvLyDmmK/lkKbliIblnZfkuIrkvKAKICAgICAgICAgIGNodW5rU2l6ZToxKjEwMjQqMTAyNCwgLy8g5YiG5Z2X5aSn5bCP77yI6buY6K6kNU3vvIkKICAgICAgICAgIHRocmVhZHM6MywgLy8g5byA5ZCv5aSa5Liq57q/56iL77yI6buY6K6kM+S4qu+8iQogICAgICAgICAgcHJlcGFyZU5leHRGaWxlOnRydWUvLyDlhYHorrjlnKjmlofku7bkvKDovpPml7bmj5DliY3miorkuIvkuIDkuKrmlofku7blh4blpIflpb0KICAgICAgICB9CiAgICAgICk7CgogICAgICAvLyDlsIbmlofku7bmt7vliqDliLDpmJ/liJcKICAgICAgdGhpcy51cGxvYWRlci5vbigiZmlsZVF1ZXVlZCIsIGZ1bmN0aW9uKGZpbGUpIHsKICAgICAgICAgIHRoaXMudXBsb2FkRmlsZSA9IGZpbGU7CiAgICAgICAgICB0aGlzLnBlcmNlbnRhZ2UgPSAwOwoKICAgICAgICB9LmJpbmQodGhpcykKICAgICAgKTsKICAgICAgLy/pgInmi6nmlofku7blkI7op6blj5EKICAgICAgdGhpcy51cGxvYWRlci5vbigiYmVmb3JlRmlsZVF1ZXVlZCIsIGZ1bmN0aW9uKGZpbGUpIHsKLy8gICAgIHRoaXMudXBsb2FkZXIucmVtb3ZlRmlsZShmaWxlKQogICAgICAgIC8v6YeN572udXBsb2FkZXIKICAgICAgICB0aGlzLnVwbG9hZGVyLnJlc2V0KCkKICAgICAgICB0aGlzLnBlcmNlbnRhZ2UgPSAwOwogICAgICB9LmJpbmQodGhpcykpOwoKICAgICAgLy8g55uR5o6n5LiK5Lyg6L+b5bqmCiAgICAgIC8vIHBlcmNlbnRhZ2U65Luj6KGo5LiK5Lyg5paH5Lu255qE55m+5YiG5q+UCiAgICAgIHRoaXMudXBsb2FkZXIub24oInVwbG9hZFByb2dyZXNzIiwgZnVuY3Rpb24oZmlsZSwgcGVyY2VudGFnZSkgewogICAgICAgICAgdGhpcy5wZXJjZW50YWdlID0gTWF0aC5jZWlsKHBlcmNlbnRhZ2UgKiAxMDApOwogICAgICB9LmJpbmQodGhpcykpOwogICAgICAvL+S4iuS8oOWksei0peinpuWPkQogICAgICB0aGlzLnVwbG9hZGVyLm9uKCJ1cGxvYWRFcnJvciIsIGZ1bmN0aW9uKGZpbGUscmVhc29uKSB7CiAgICAgICAgY29uc29sZS5sb2cocmVhc29uKQogICAgICAgIGFsZXJ0KCLkuIrkvKDmlofku7blpLHotKUiKTsKICAgICAgfSk7CiAgICAgIC8v5LiK5Lyg5oiQ5Yqf6Kem5Y+RCiAgICAgIHRoaXMudXBsb2FkZXIub24oInVwbG9hZFN1Y2Nlc3MiLCBmdW5jdGlvbihmaWxlLHJlc3BvbnNlICkgewogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKQogICAgICAgIGFsZXJ0KCLkuIrkvKDmlofku7bmiJDlip/vvIEiKTsKICAgICAgfSk7CgogICAgfQogIH0KCg=="},{"version":3,"sources":["upload-bigfile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"upload-bigfile.vue","sourceRoot":"src/module-organization/pages/media-manage/components","sourcesContent":["<template>\n<div><br/>\n  操作步骤：<br/>\n  1、点击“选择文件”，选择要上传的文件<br/>\n  2、点击“开始上传”，开始上传文件<br/>\n  3、如需重新上传请重复上边的步骤。<br/><br/>\n\n  <div id=\"uploader\" class=\"wu-example\">\n    <div class=\"btns\" style=\"float:left;padding-right: 20px\">\n      <div id=\"picker\">选择文件</div>\n    </div>\n    <div id=\"ctlBtn\" class=\"webuploader-pick\" @click=\"upload()\">开始上传</div>\n\n  </div>\n  <!--用来存放文件信息-->\n  <div id=\"thelist\" class=\"uploader-list\" >\n    <div v-if=\"uploadFile.id\" :id='uploadFile.id'><span>{{uploadFile.name}}</span>&nbsp;<span class='percentage'>{{percentage}}%</span></div>\n\n  </div>\n</div>\n</template>\n<script>\n  import $ from '../../../../../static/plugins/jquery/dist/jquery.js'\n  import webuploader from '../../../../../static/plugins/webuploader/dist/webuploader.js'\n  import '../../../../../static/css/webuploader/webuploader.css'\n  export default{\n    data(){\n      return{\n        uploader:{},\n        uploadFile:{},\n        percentage:0,\n        fileMd5:''\n      }\n    },\n    methods:{\n      //开始上传\n      upload(){\n        if(this.uploadFile && this.uploadFile.id){\n          this.uploader.upload(this.uploadFile.id);\n        }else{\n          alert(\"请选择文件\");\n        }\n      }\n    },\n    mounted(){\n//      var fileMd5;\n//      var uploadFile;\n      WebUploader.Uploader.register({\n          \"before-send-file\":\"beforeSendFile\",\n          \"before-send\":\"beforeSend\",\n          \"after-send-file\":\"afterSendFile\"\n        },{\n          beforeSendFile:function(file) {\n            // 创建一个deffered,用于通知是否完成操作\n            var deferred = WebUploader.Deferred();\n            // 计算文件的唯一标识，用于断点续传\n            (new WebUploader.Uploader()).md5File(file, 0, 100*1024*1024)\n              .then(function(val) {\n\n                this.fileMd5 = val;\n                this.uploadFile = file;\n                //alert(fileMd5 )\n                //向服务端请求注册上传文件\n                $.ajax(\n                  {\n                    type:\"POST\",\n                    url:\"/api/media/upload/register\",\n                    data:{\n                      // 文件唯一表示\n                      fileMd5:this.fileMd5,\n                      fileName: file.name,\n                      fileSize:file.size,\n                      mimetype:file.type,\n                      fileExt:file.ext\n                    },\n                    dataType:\"json\",\n                    success:function(response) {\n                      if(response.success) {\n                        //alert('上传文件注册成功开始上传');\n                        deferred.resolve();\n                      } else {\n                        alert(response.message);\n                        deferred.reject();\n                      }\n                    }\n                  }\n                );\n              }.bind(this));\n\n            return deferred.promise();\n          }.bind(this),\n          beforeSend:function(block) {\n            var deferred = WebUploader.Deferred();\n            // 每次上传分块前校验分块，如果已存在分块则不再上传，达到断点续传的目的\n            $.ajax(\n              {\n                type:\"POST\",\n                url:\"/api/media/upload/checkchunk\",\n                data:{\n                  // 文件唯一表示\n                  fileMd5:this.fileMd5,\n                  // 当前分块下标\n                  chunk:block.chunk,\n                  // 当前分块大小\n                  chunkSize:block.end-block.start\n                },\n                dataType:\"json\",\n                success:function(response) {\n                  if(response.ifExist) {\n                    // 分块存在，跳过该分块\n                    deferred.reject();\n                  } else {\n                    // 分块不存在或不完整，重新发送\n                    deferred.resolve();\n                  }\n                }\n              }\n            );\n            //构建fileMd5参数，上传分块时带上fileMd5\n            this.uploader.options.formData.fileMd5 = this.fileMd5;\n            this.uploader.options.formData.chunk = block.chunk;\n            return deferred.promise();\n          }.bind(this),\n          afterSendFile:function(file) {\n            // 合并分块\n            $.ajax(\n              {\n                type:\"POST\",\n                url:\"/api/media/upload/mergechunks\",\n                data:{\n                  fileMd5:this.fileMd5,\n                  fileName: file.name,\n                  fileSize:file.size,\n                  mimetype:file.type,\n                  fileExt:file.ext\n                },\n                success:function(response){\n\n                }\n              }\n            );\n          }.bind(this)\n        }\n      );\n      // 创建uploader对象，配置参数\n      this.uploader = WebUploader.create(\n        {\n          swf:\"/static/plugins/webuploader/dist/Uploader.swf\",//上传文件的flash文件，浏览器不支持h5时启动flash\n          server:\"/api/media/upload/uploadchunk\",//上传分块的服务端地址，注意跨域问题\n          fileVal:\"file\",//文件上传域的name\n          pick:\"#picker\",//指定选择文件的按钮容器\n          auto:false,//手动触发上传\n          disableGlobalDnd:true,//禁掉整个页面的拖拽功能\n          chunked:true,// 是否分块上传\n          chunkSize:1*1024*1024, // 分块大小（默认5M）\n          threads:3, // 开启多个线程（默认3个）\n          prepareNextFile:true// 允许在文件传输时提前把下一个文件准备好\n        }\n      );\n\n      // 将文件添加到队列\n      this.uploader.on(\"fileQueued\", function(file) {\n          this.uploadFile = file;\n          this.percentage = 0;\n\n        }.bind(this)\n      );\n      //选择文件后触发\n      this.uploader.on(\"beforeFileQueued\", function(file) {\n//     this.uploader.removeFile(file)\n        //重置uploader\n        this.uploader.reset()\n        this.percentage = 0;\n      }.bind(this));\n\n      // 监控上传进度\n      // percentage:代表上传文件的百分比\n      this.uploader.on(\"uploadProgress\", function(file, percentage) {\n          this.percentage = Math.ceil(percentage * 100);\n      }.bind(this));\n      //上传失败触发\n      this.uploader.on(\"uploadError\", function(file,reason) {\n        console.log(reason)\n        alert(\"上传文件失败\");\n      });\n      //上传成功触发\n      this.uploader.on(\"uploadSuccess\", function(file,response ) {\n        console.log(response)\n        alert(\"上传文件成功！\");\n      });\n\n    }\n  }\n\n</script>\n<style scoped>\n\n\n</style>\n"]}]}